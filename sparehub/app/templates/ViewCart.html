{% extends "base.html" %}

{% block title %}Cart{% endblock title %}

{% block content %}
<div class="min-h-screen bg-gradient-to-b from-black via-[#0f0404] to-black
            text-white py-16 px-4">

    <div class="max-w-6xl mx-auto pt-20 md:pt-20">

        <!-- HEADER -->
        <div class="flex items-center justify-between mb-10">
            <h1 class="text-4xl font-black tracking-tight">
                Your Cart
            </h1>
            <span class="text-sm text-gray-400">
                {{ products|length }} items
            </span>
        </div>

        <!-- CART LIST -->
        <div class="space-y-1">

            {%if products%}
            {% for i in products %}
            <div class="relative bg-black/40 border border-red-900/30
                        rounded-2xl p-6
                        hover:border-red-600/40 transition">

                <!-- GLOW -->
                <div class="absolute inset-0 rounded-2xl
                            opacity-0 hover:opacity-100 transition
                            bg-red-900/10 blur-xl"></div>

                <div class="relative z-10 flex flex-col md:flex-row
                            items-center gap-6">

                    <!-- IMAGE -->
                    <img src="{{ i.product.image.url }}"
                         class="w-28 h-28 object-cover rounded-xl
                                border border-white/10"
                         alt="no">

                    <!-- INFO -->
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold">
                            {{ i.product.name }}
                        </h3>
                        <p class="text-sm text-gray-400 mt-1">
                            {{ i.product.brand }} · {{ i.product.model }}
                        </p>
                        <p class="text-lg font-bold text-red-400 mt-2">
                            ₹{{ i.product.price }}
                        </p>
                    </div>

                    <!-- QTY CONTROL -->
                    <div class="flex items-center gap-3">
                        <form action="{% url 'add_cart' i.product.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit"
                                    class="w-9 h-9 rounded-full
                                           bg-red-700 hover:bg-red-600 transition">
                                +
                            </button>
                        </form>

                        <div class="w-12 h-12 flex items-center justify-center
                                    bg-black border border-white/20
                                    rounded-xl font-bold">
                            {{ i.quantity }}
                        </div>

                        <form action="{% url 'remove' i.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit"
                                    {% if i.quantity <= 1 %}disabled{% endif %}
                                    class="w-9 h-9 rounded-full
                                           bg-gray-700 hover:bg-gray-600
                                           disabled:opacity-40 transition">
                                −
                            </button>
                        </form>
                    </div>

                    <!-- ACTIONS -->
                    <div class="flex flex-col gap-3">
                        <a href="{% url 'remove' i.id %}">
                            <button class="px-5 py-2 text-sm
                                           border border-red-800/40
                                           text-red-400 rounded-xl
                                           hover:bg-red-900/20 transition">
                                Remove
                            </button>
                        </a>

                        <a href="{% url 'cart_checkout_id' i.product_id %}">
                            <button class="px-5 py-2 text-sm
                                           bg-green-700 hover:bg-green-600
                                           rounded-xl transition">
                                Buy Now
                            </button>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
            {%else%}
            <h1 class="text-center text-gray-400 text-xl mt-20">
                No product
            </h1>
            {%endif%}
        </div>

        <!-- SUMMARY -->
        <div class="mt-14 flex flex-col md:flex-row
                    justify-between items-center gap-6
                    bg-black/60 border border-red-900/30
                    rounded-2xl p-8">

            <div class="text-xl font-semibold">
                Total Amount:
                <span class="text-red-500 font-black ml-2">
                    ₹{{ total }}
                </span>
            </div>

            <a href="{% url 'cart_checkout' %}">
                <button class="px-10 py-4 text-lg font-bold
                               bg-red-700 hover:bg-red-600
                               rounded-2xl transition
                               shadow-lg shadow-red-900/40">
                    Place Order
                </button>
            </a>
        </div>

    </div>
</div>
{% endblock content %}
